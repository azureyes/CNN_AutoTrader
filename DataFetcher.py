# -*- coding: utf-8 -*-
"""
Created on Fri Apr 20 10:26:32 2018

@author: yewei
"""

import tushare as ts
from datetime import date
import pandas as pd
import os

defaultStartDate = '2007-01-01'
defaultEndDate = str(date.today())
isIndex = False

#INDEX_LIST = [u'002233', u'600687', u'002368', u'002001', u'000969', u'600757', u'600393', u'600100', u'002444', u'600089', u'300033', u'600729', u'600547', u'601985', u'002428', u'600900', u'002008', u'600750', u'600125', u'600316', u'000069', u'600332', u'600108', u'600682', u'600416', u'000156', u'600869', u'601021', u'002375', u'600086', u'002078', u'001696', u'002056', u'601155', u'002051', u'000338', u'600122', u'600187', u'601880', u'000100', u'002221', u'000981', u'600518', u'002044', u'002434', u'600663', u'600835', u'000669', u'601009', u'600594', u'600657', u'000680', u'000718', u'600176', u'603169', u'002699', u'000988', u'000778', u'300001', u'600525', u'002317', u'601939', u'600298', u'002266', u'002465', u'002063', u'600478', u'000538', u'600338', u'002470', u'000006', u'000157', u'000612', u'600718', u'600284', u'600160', u'601311', u'600104', u'002466', u'002049', u'603816', u'600580', u'603019', u'000830', u'000786', u'002544', u'000031', u'600939', u'300058', u'002673', u'002714', u'600011', u'002028', u'600151', u'002190', u'600837', u'002294', u'601633', u'002681', u'000939', u'600309', u'002250', u'000938', u'601607', u'600177', u'600584', u'002815', u'000061', u'300144', u'600751', u'600549', u'000627', u'000636', u'002608', u'601163', u'601099', u'600566', u'002583', u'002352', u'002183', u'002019', u'002174', u'300251', u'603883', u'000423', u'600300', u'002551', u'600582', u'000596', u'601688', u'002426', u'002663', u'600362', u'002408', u'002707', u'600919', u'600635', u'002332', u'000592', u'002022', u'600208', u'600267', u'002701', u'002670', u'600521', u'603799', u'300017', u'000667', u'600717', u'000513', u'600050', u'600031', u'000566', u'000887', u'000519', u'002468', u'300297', u'300147', u'000426', u'000926', u'600811', u'000703', u'002739', u'600737', u'000049', u'002354', u'600674', u'000060', u'002558', u'002106', u'600839', u'601800', u'601555', u'601997', u'600545', u'002273', u'601811', u'600346', u'603806', u'000877', u'002024', u'000825', u'002236', u'601016', u'600875', u'600481', u'002018', u'601933', u'600240', u'300122', u'000723', u'000501', u'002241', u'000671', u'002437', u'002146', u'002038', u'600004', u'601877', u'601127', u'300070', u'002344', u'601216', u'600648', u'603328', u'300197', u'600111', u'601118', u'300182', u'600741', u'600438', u'000401', u'000876', u'600585', u'002602', u'002450', u'600388', u'000783', u'000547', u'600066', u'002371', u'000987', u'002572', u'600862', u'002477', u'000975', u'600138', u'601898', u'601699', u'600048', u'000528', u'600516', u'000027', u'000685', u'300166', u'002665', u'600277', u'600660', u'600618', u'600064', u'600637', u'002358', u'600575', u'600859', u'002261', u'600754', u'600259', u'300324', u'002390', u'600157', u'000998', u'000025', u'002191', u'600019', u'002573', u'000568', u'600409', u'002831', u'002475', u'002506', u'002027', u'600787', u'600926', u'601718', u'600936', u'600517', u'603658', u'000572', u'000963', u'600171', u'600184', u'600018', u'000729', u'600536', u'600056', u'002500', u'600458', u'002223', u'600664', u'601233', u'300113', u'000078', u'600623', u'002405', u'600017', u'300291', u'601611', u'002491', u'000709', u'601390', u'600074', u'002073', u'600572', u'002555', u'600039', u'601988', u'600645', u'600881', u'600996', u'600373', u'601969', u'000732', u'601777', u'002153', u'600500', u'600820', u'002366', u'600158', u'002280', u'601899', u'600773', u'002456', u'601225', u'603589', u'000895', u'603001', u'002230', u'600276', u'600748', u'600959', u'600863', u'000897', u'600557', u'002092', u'600970', u'600169', u'002195', u'600059', u'600499', u'601168', u'002292', u'000536', u'600600', u'000661', u'600161', u'002807', u'601878', u'002489', u'603198', u'002244', u'601628', u'000999', u'603515', u'002123', u'601881', u'600233', u'300266', u'002281', u'002325', u'601901', u'000806', u'002508', u'600266', u'600029', u'000413', u'300124', u'300039', u'002002', u'600655', u'600085', u'002142', u'300315', u'000728', u'600673', u'600016', u'603077', u'000758', u'002512', u'002517', u'600068', u'600201', u'002745', u'002152', u'601211', u'000002', u'300088', u'603858', u'000930', u'600801', u'002410', u'000898', u'600153', u'600415', u'601228', u'002416', u'600694', u'600015', u'000333', u'603766', u'002342', u'002345', u'603444', u'600383', u'002642', u'002064', u'000766', u'600126', u'601991', u'600795', u'600058', u'600967', u'600053', u'000792', u'000848', u'600739', u'600280', u'000630', u'600325', u'300133', u'601857', u'603228', u'600292', u'601966', u'002797', u'601788', u'603025', u'000158', u'601866', u'000540', u'300059', u'002118', u'601088', u'300383', u'000662', u'600498', u'000425', u'300274', u'000961', u'002271', u'603556', u'001979', u'600597', u'601166', u'600141', u'601992', u'600282', u'601333', u'603000', u'002839', u'603225', u'600410', u'600578', u'300115', u'002032', u'002640', u'603569', u'601872', u'002422', u'002179', u'600317', u'601928', u'300010', u'300273', u'600816', u'000878', u'600435', u'600535', u'000543', u'600062', u'600436', u'300136', u'601375', u'000979', u'600894', u'601001', u'002041', u'002424', u'600312', u'600909', u'000652', u'601128', u'000563', u'601288', u'600887', u'000402', u'002588', u'002385', u'002252', u'600352', u'600289', u'600639', u'601608', u'600685', u'600307', u'002411', u'000001', u'600884', u'600872', u'601012', u'000400', u'601600', u'600628', u'002709', u'000028', u'000959', u'603355', u'600588', u'002242', u'600908', u'002415', u'601398', u'000681', u'601002', u'601000', u'600640', u'002308', u'600583', u'601888', u'000066', u'300043', u'603568', u'002503', u'000559', u'300072', u'002479', u'002268', u'600221', u'300199', u'300202', u'002011', u'000983', u'601668', u'000776', u'603877', u'300024', u'600808', u'300244', u'002155', u'600743', u'000727', u'002147', u'000858', u'600642', u'300116', u'600028', u'000089', u'000039', u'000829', u'601678', u'002285', u'600094', u'600633', u'600006', u'600522', u'600196', u'600614', u'603188', u'000625', u'002310', u'000418', u'000488', u'603888', u'601318', u'000937', u'600503', u'002030', u'603369', u'603160', u'600770', u'002439', u'600482', u'600009', u'600390', u'300026', u'600643', u'603993', u'300015', u'600703', u'002340', u'000587', u'600115', u'000686', u'000738', u'600977', u'002440', u'600073', u'600649', u'000552', u'000415', u'600392', u'002304', u'600155', u'600195', u'002353', u'300253', u'603528', u'002131', u'300376', u'600688', u'600270', u'600060', u'000777', u'600895', u'600038', u'601018', u'000166', u'000541', u'601958', u'601766', u'600030', u'600958', u'600219', u'300257', u'600369', u'000860', u'600291', u'002299', u'600380', u'601919', u'002400', u'000997', u'002276', u'600340', u'000600', u'002007', u'000990', u'002460', u'300055', u'600704', u'002202', u'000581', u'000960', u'600885', u'000826', u'002407', u'600329', u'600489', u'601377', u'002005', u'002601', u'600406', u'601229', u'002269', u'002672', u'600010', u'300159', u'600395', u'601117', u'000816', u'600418', u'002122', u'002818', u'600978', u'600166', u'002277', u'002505', u'002603', u'600776', u'600690', u'000021', u'002081', u'600376', u'000090', u'600256', u'000839', u'002050', u'600563', u'000012', u'600120', u'600893', u'002359', u'600260', u'600315', u'601212', u'600519', u'600871', u'600880', u'002251', u'002254', u'601818', u'601006', u'002128', u'002176', u'002065', u'600037', u'600026', u'000690', u'600426', u'002127', u'600366', u'601200', u'300003', u'600118', u'600079', u'600823', u'603377', u'600705', u'000656', u'601336', u'000651', u'600999', u'002373', u'600021', u'000598', u'002013', u'600143', u'600759', u'002004', u'600460', u'002463', u'002657', u'601998', u'002048', u'000762', u'601231', u'600827', u'600971', u'600036', u'600651', u'601111', u'600000', u'002249', u'600372', u'600874', u'300002', u'601198', u'002431', u'600428', u'600587', u'603868', u'000062', u'300134', u'600023', u'601618', u'600993', u'000623', u'600008', u'002311', u'600611', u'300032', u'002635', u'600061', u'600170', u'600755', u'601717', u'600606', u'600466', u'000977', u'300027', u'002841', u'300287', u'601169', u'600348', u'600598', u'000712', u'600804', u'600886', u'601689', u'603833', u'600570', u'600297', u'002384', u'601328', u'000050', u'601601', u'600188', u'002736', u'600917', u'002093', u'600109', u'000008', u'002482', u'000768', u'600098', u'002624', u'300146', u'600271', u'600485', u'000750', u'600826', u'601727', u'002414', u'002594', u'002074', u'000725', u'601020', u'000503', u'002392', u'600022', u'600216', u'600848', u'600422', u'600765', u'600183', u'000063', u'601989', u'600879', u'000009', u'000761', u'000970', u'600335', u'000099', u'600511', u'600179', u'601669', u'000807', u'601186', u'002690', u'600565', u'002589']
#INDEX_LIST = [u'600763', u'300039', u'002233', u'600687', u'600387', u'603389', u'600769', u'600393', u'600100', u'600391', u'002065', u'600067', u'002444', u'300033', u'000039', u'600468', u'600311', u'601985', u'600814', u'600125', u'603933', u'603709', u'603089', u'600561', u'600682', u'600416', u'600379', u'600761', u'603912', u'603536', u'002375', u'603339', u'601155', u'600239', u'603667', u'600197', u'002500', u'600805', u'600518', u'600800', u'002044', u'601718', u'603016', u'601789', u'600056', u'300055', u'600200', u'603258', u'603223', u'002807', u'603348', u'603538', u'600127', u'600176', u'603169', u'600651', u'600846', u'000778', u'603218', u'600760', u'603113', u'002317', u'600598', u'600527', u'002063', u'600845', u'600664', u'600571', u'000725', u'600231', u'002470', u'600745', u'600319', u'603569', u'600284', u'600609', u'600653', u'600209', u'600104', u'603010', u'601098', u'600352', u'603383', u'601700', u'000031', u'300058', u'600310', u'002183', u'600963', u'002714', u'600011', u'600983', u'600847', u'600668', u'601368', u'002190', u'600837', u'601633', u'600503', u'002681', u'600188', u'600325', u'603939', u'600060', u'000938', u'603083', u'603208', u'600522', u'603387', u'601595', u'300144', u'000541', u'600549', u'600288', u'603499', u'600747', u'600716', u'603020', u'600573', u'603131', u'601099', u'600490', u'002583', u'002352', u'603365', u'603069', u'601218', u'600227', u'000776', u'600531', u'600198', u'300251', u'603966', u'000587', u'600273', u'600876', u'603331', u'000423', u'600300', u'600764', u'300146', u'000596', u'600569', u'600678', u'600482', u'603133', u'600281', u'600714', u'603309', u'600113', u'600973', u'601010', u'600828', u'002276', u'603357', u'002707', u'600919', u'600708', u'600900', u'002332', u'603619', u'002022', u'600208', u'600390', u'002670', u'600521', u'603816', u'000786', u'000667', u'600386', u'603103', u'603167', u'603976', u'300324', u'601339', u'600576', u'603600', u'601177', u'000566', u'601126', u'000887', u'600217', u'300147', u'600811', u'600881', u'000049', u'600076', u'603200', u'600206', u'601208', u'000060', u'603386', u'600377', u'002482', u'603963', u'601800', u'300166', u'600979', u'601997', u'002032', u'600545', u'600644', u'002024', u'000825', u'600792', u'600677', u'600986', u'601069', u'600203', u'600476', u'603377', u'600481', u'600773', u'601933', u'600145', u'002503', u'600933', u'600537', u'300122', u'603918', u'600493', u'002241', u'600301', u'603055', u'002106', u'002146', u'600613', u'600126', u'600279', u'000848', u'603278', u'002344', u'601216', u'603848', u'600648', u'603059', u'002051', u'300197', u'600111', u'600378', u'000338', u'600734', u'600850', u'600084', u'600812', u'600326', u'603030', u'603871', u'600066', u'603166', u'000987', u'002572', u'000975', u'600361', u'600432', u'600138', u'601898', u'000100', u'601699', u'600495', u'300059', u'002366', u'600155', u'002665', u'600158', u'600063', u'600641', u'603197', u'600618', u'600532', u'603117', u'600897', u'603826', u'601949', u'600168', u'600860', u'603685', u'603828', u'000025', u'600119', u'603319', u'600746', u'600460', u'600604', u'000568', u'601999', u'600409', u'002831', u'600110', u'601618', u'002506', u'002027', u'603580', u'600771', u'600295', u'600663', u'000895', u'600470', u'600719', u'600624', u'000572', u'002230', u'600026', u'603960', u'601929', u'600330', u'600758', u'600211', u'002223', u'603421', u'603936', u'603588', u'601233', u'300113', u'000078', u'600059', u'002405', u'600389', u'601611', u'600841', u'002491', u'000709', u'600547', u'600866', u'603458', u'601798', u'600376', u'600355', u'601988', u'600853', u'603659', u'600711', u'600996', u'603916', u'600779', u'600132', u'600688', u'002153', u'600117', u'600496', u'601900', u'601899', u'603106', u'600567', u'002456', u'600080', u'603589', u'600936', u'603001', u'603787', u'600276', u'603308', u'000897', u'603716', u'601838', u'002195', u'601500', u'600784', u'601168', u'000536', u'603605', u'600966', u'603333', u'600855', u'603819', u'000661', u'600161', u'603817', u'600082', u'002489', u'601028', u'600425', u'600190', u'603006', u'603388', u'603238', u'000999', u'603515', u'600081', u'603177', u'601881', u'600501', u'600818', u'600233', u'603920', u'600071', u'002281', u'600159', u'000806', u'002508', u'600237', u'600777', u'603289', u'600012', u'603607', u'603656', u'600807', u'600210', u'600655', u'600085', u'601188', u'600620', u'300315', u'000728', u'600540', u'603041', u'002512', u'002745', u'603318', u'600033', u'000002', u'603858', u'002048', u'600303', u'300159', u'000898', u'603896', u'600153', u'603136', u'600351', u'603929', u'603196', u'603158', u'600694', u'603429', u'603997', u'000333', u'600701', u'603579', u'002368', u'600749', u'002342', u'601567', u'000636', u'603444', u'000156', u'600109', u'603168', u'600875', u'002064', u'603098', u'600129', u'600621', u'601991', u'600795', u'600967', u'603040', u'600483', u'600053', u'603869', u'600630', u'600202', u'600280', u'600375', u'600057', u'603269', u'300133', u'600478', u'600146', u'600856', u'000766', u'600070', u'600290', u'603322', u'603018', u'600252', u'603535', u'600098', u'600338', u'600291', u'600693', u'600498', u'600306', u'000425', u'002271', u'600733', u'603313', u'603860', u'601919', u'600961', u'601992', u'600282', u'603737', u'000860', u'601038', u'601179', u'600578', u'600797', u'603633', u'603612', u'603021', u'601872', u'600261', u'603477', u'600317', u'600363', u'603637', u'603928', u'603283', u'600160', u'002123', u'600816', u'603689', u'600435', u'000543', u'600062', u'600809', u'600477', u'002242', u'600340', u'300136', u'601258', u'600302', u'603708', u'600726', u'002041', u'002424', u'603937', u'600909', u'600283', u'603110', u'000652', u'603159', u'603496', u'002440', u'600887', u'600449', u'601186', u'603926', u'603138', u'600420', u'002038', u'603299', u'603680', u'600307', u'603908', u'600475', u'000001', u'603323', u'603557', u'600704', u'601012', u'603701', u'603758', u'600248', u'000400', u'600790', u'603665', u'600510', u'000959', u'600588', u'600266', u'601011', u'600018', u'600336', u'002325', u'600526', u'603861', u'603023', u'600090', u'000681', u'600939', u'603367', u'603606', u'603959', u'601000', u'600640', u'600583', u'601888', u'603568', u'601116', u'600962', u'600095', u'603226', u'002663', u'601015', u'603818', u'600115', u'002268', u'600221', u'600692', u'601086', u'600356', u'601101', u'600096', u'600824', u'600299', u'600808', u'600858', u'002155', u'603618', u'601318', u'600723', u'603039', u'600287', u'600335', u'600642', u'600883', u'600329', u'600599', u'300124', u'601616', u'603101', u'600187', u'600844', u'002384', u'002414', u'600831', u'600258', u'000829', u'600781', u'600108', u'600815', u'600094', u'603126', u'600006', u'603648', u'600594', u'600196', u'600106', u'603298', u'600614', u'603188', u'000157', u'002310', u'000418', u'000488', u'603639', u'600783', u'603300', u'603369', u'600555', u'600223', u'600770', u'002439', u'600529', u'601808', u'600551', u'600635', u'603086', u'600643', u'603721', u'600822', u'600368', u'300015', u'603056', u'601566', u'601008', u'600981', u'600889', u'600502', u'000686', u'600143', u'600977', u'603955', u'603919', u'600178', u'002191', u'000066', u'600016', u'000061', u'600579', u'600195', u'002353', u'603077', u'300253', u'300376', u'601777', u'600309', u'600825', u'600038', u'600908', u'002018', u'600768', u'600634', u'000981', u'601958', u'601766', u'600766', u'603038', u'600030', u'603011', u'600226', u'603599', u'603899', u'300257', u'603189', u'600546', u'600358', u'002299', u'002221', u'600141', u'600339', u'000401', u'002152', u'600548', u'600251', u'000878', u'600735', u'600436', u'002007', u'002460', u'601558', u'600156', u'300088', u'600872', u'600796', u'601666', u'600998', u'600466', u'000960', u'600775', u'002408', u'600382', u'600257', u'000826', u'600891', u'601952', u'002818', u'601377', u'002005', u'600647', u'002601', u'600406', u'603528', u'600810', u'600864', u'603609', u'000627', u'603345', u'300010', u'600395', u'600698', u'002122', u'002390', u'601158', u'600978', u'002277', u'002505', u'002608', u'600690', u'600446', u'002081', u'002428', u'000090', u'601058', u'002269', u'603679', u'603917', u'603080', u'600976', u'600563', u'000012', u'600345', u'603886', u'600721', u'603116', u'601005', u'600519', u'603500', u'600736', u'603260', u'002254', u'601818', u'601006', u'600322', u'600782', u'600089', u'600037', u'601113', u'600543', u'000690', u'600426', u'601828', u'601579', u'601677', u'603181', u'600366', u'601200', u'300003', u'600118', u'600523', u'603066', u'600877', u'603050', u'000656', u'600135', u'600999', u'600806', u'600530', u'600622', u'603501', u'002004', u'002285', u'600099', u'603156', u'000762', u'600452', u'601231', u'603922', u'002019', u'600798', u'601111', u'600397', u'600372', u'603505', u'600169', u'600780', u'600671', u'300002', u'601198', u'601106', u'603596', u'002431', u'603778', u'600051', u'600182', u'600220', u'300134', u'600742', u'600697', u'603866', u'600433', u'600993', u'600662', u'600019', u'601388', u'300116', u'002002', u'600250', u'600611', u'300032', u'002635', u'600225', u'600515', u'603311', u'600755', u'600381', u'600606', u'000685', u'600480', u'300027', u'603877', u'603803', u'603466', u'600367', u'600804', u'600886', u'603823', u'600297', u'000050', u'601601', u'600785', u'600707', u'600069', u'600137', u'000008', u'600029', u'600868', u'600836', u'600969', u'600149', u'603518', u'603329', u'600369', u'603063', u'601688', u'603118', u'603686', u'603002', u'600418', u'600880', u'600834', u'002392', u'000858', u'603315', u'600218', u'600848', u'600667', u'603566', u'603968', u'000792', u'000063', u'600121', u'603385', u'600748', u'601989', u'600879', u'000009', u'600619', u'600520', u'600744', u'300287', u'603856', u'601100', u'002815', u'002690', u'603728', u'600892', u'600565', u'002589', u'600463', u'603266', u'600896', u'000630', u'002001', u'000969', u'600757', u'600408', u'603703', u'603901', u'603336', u'603603', u'600729', u'600559', u'603776', u'603306', u'600298', u'601019', u'002008', u'603033', u'600750', u'603883', u'600419', u'600316', u'000069', u'600332', u'600123', u'603855', u'600078', u'600869', u'601021', u'600086', u'002078', u'001696', u'002056', u'002437', u'601360', u'600741', u'603165', u'600122', u'603978', u'600713', u'601880', u'603628', u'600354', u'603008', u'002434', u'600401', u'600292', u'603626', u'600835', u'603879', u'601009', u'600854', u'600657', u'000680', u'600131', u'603003', u'603903', u'000718', u'603881', u'002699', u'603043', u'600116', u'300001', u'601966', u'603808', u'601939', u'603320', u'600423', u'002266', u'002465', u'603516', u'603822', u'600370', u'603222', u'000538', u'601882', u'603663', u'601588', u'603286', u'300115', u'000612', u'601788', u'603767', u'600192', u'600988', u'603630', u'600488', u'603707', u'600833', u'002049', u'603799', u'600580', u'600626', u'603019', u'000830', u'002544', u'601002', u'600403', u'002673', u'603042', u'002028', u'600151', u'600873', u'002294', u'600508', u'000939', u'603989', u'603699', u'600865', u'600255', u'603906', u'002250', u'601607', u'600177', u'600584', u'600230', u'600318', u'600751', u'603838', u'601886', u'600533', u'603661', u'600050', u'600333', u'600776', u'600148', u'601088', u'603356', u'603991', u'603676', u'600497', u'601199', u'603729', u'002174', u'603977', u'600229', u'600365', u'603026', u'600676', u'603829', u'603507', u'300297', u'603567', u'600582', u'601211', u'601727', u'603366', u'002252', u'600507', u'002426', u'600448', u'603268', u'600903', u'600362', u'002013', u'600499', u'600885', u'600212', u'000592', u'600240', u'001979', u'600870', u'002701', u'603326', u'600960', u'600035', u'300017', u'600238', u'600717', u'000513', u'600199', u'600031', u'603711', u'603825', u'600605', u'603078', u'600830', u'603789', u'600193', u'000519', u'002468', u'600728', u'603239', u'603396', u'000426', u'000926', u'603036', u'600371', u'000703', u'600791', u'600293', u'002340', u'002354', u'600674', u'600585', u'603602', u'600839', u'600360', u'002385', u'000528', u'601555', u'603722', u'600150', u'601811', u'600658', u'603806', u'600228', u'000877', u'002411', u'600439', u'603186', u'002236', u'603203', u'601016', u'603987', u'600512', u'601969', u'600097', u'603615', u'600592', u'000723', u'600072', u'600020', u'600285', u'000501', u'000671', u'603779', u'600695', u'000988', u'600004', u'603880', u'601127', u'300070', u'600691', u'002118', u'002640', u'600888', u'603305', u'601118', u'300182', u'603099', u'600438', u'603128', u'000876', u'002558', u'002602', u'002450', u'600990', u'600388', u'603889', u'603035', u'000783', u'603900', u'600278', u'002371', u'600247', u'600821', u'002477', u'603337', u'603090', u'600048', u'600516', u'000027', u'603730', u'603108', u'600975', u'600277', u'603727', u'600660', u'600064', u'600637', u'002358', u'600552', u'603139', u'600575', u'603970', u'600398', u'002179', u'002261', u'600491', u'600259', u'600680', u'002273', u'600157', u'000998', u'603519', u'600874', u'601225', u'601326', u'603660', u'600971', u'600666', u'601369', u'002475', u'601137', u'600787', u'600679', u'603617', u'600926', u'600517', u'000413', u'002573', u'600128', u'603669', u'000963', u'600171', u'603809', u'600265', u'600461', u'600985', u'600536', u'603638', u'603378', u'603990', u'600458', u'600396', u'603393', u'600313', u'601366', u'603938', u'603129', u'600017', u'300291', u'000761', u'603601', u'601390', u'600074', u'600353', u'002073', u'600173', u'603100', u'600572', u'600570', u'002555', u'600039', u'603180', u'600645', u'600737', u'600373', u'000732', u'603079', u'603717', u'601636', u'000062', u'603303', u'600820', u'600249', u'600469', u'600091', u'002280', u'600712', u'603368', u'600267', u'600665', u'600184', u'000729', u'601328', u'600629', u'600623', u'600959', u'600863', u'600557', u'002092', u'600133', u'600970', u'600600', u'603876', u'603198', u'603996', u'600894', u'600136', u'600513', u'600068', u'603798', u'600275', u'603683', u'603766', u'601878', u'601007', u'600359', u'603058', u'600731', u'600722', u'002244', u'600861', u'600851', u'600699', u'600789', u'601107', u'600323', u'300266', u'603577', u'601901', u'603611', u'600186', u'601519', u'600262', u'600602', u'600738', u'000930', u'603636', u'603888', u'600007', u'002142', u'600673', u'000758', u'002517', u'601311', u'000997', u'600201', u'600753', u'600456', u'600982', u'603399', u'601799', u'600778', u'600801', u'603696', u'600415', u'601228', u'600756', u'002416', u'600661', u'600015', u'600444', u'603506', u'603363', u'002345', u'600562', u'601288', u'600383', u'002642', u'600556', u'600997', u'600638', u'600992', u'601877', u'603228', u'600589', u'600183', u'002588', u'603859', u'603878', u'600689', u'600505', u'600550', u'601857', u'601020', u'601108', u'000021', u'600429', u'603081', u'603668', u'600525', u'600595', u'600718', u'603718', u'603025', u'000158', u'601866', u'000540', u'600061', u'600754', u'601163', u'300383', u'000662', u'603179', u'603909', u'601139', u'000961', u'600400', u'603556', u'600107', u'600597', u'601166', u'600025', u'603288', u'601333', u'600152', u'603000', u'002839', u'603076', u'600410', u'603980', u'603183', u'603328', u'600650', u'600088', u'002422', u'600636', u'603882', u'600965', u'603227', u'601928', u'603088', u'600506', u'600767', u'600675', u'603031', u'600421', u'603416', u'600535', u'002841', u'600077', u'603986', u'603698', u'601375', u'000979', u'601226', u'601001', u'603999', u'600560', u'600343', u'600312', u'600882', u'600617', u'603811', u'601128', u'603578', u'002739', u'000563', u'600838', u'603157', u'000402', u'603359', u'000669', u'600724', u'603800', u'603161', u'600289', u'600509', u'603895', u'600730', u'601608', u'600685', u'600732', u'603456', u'600884', u'600320', u'603232', u'600175', u'603777', u'601600', u'600455', u'600743', u'002709', u'600895', u'603355', u'600817', u'603316', u'600596', u'601965', u'601398', u'000547', u'600568', u'600603', u'600327', u'603726', u'002308', u'603380', u'603890', u'300043', u'603488', u'000559', u'600652', u'002479', u'600500', u'603358', u'002466', u'600987', u'300202', u'600163', u'000983', u'600185', u'603958', u'603005', u'601518', u'603028', u'603199', u'600213', u'600577', u'600628', u'000727', u'002147', u'002292', u'603801', u'600590', u'000028', u'600232', u'300273', u'600616', u'603527', u'600459', u'600180', u'600093', u'600715', u'603517', u'000089', u'603012', u'601678', u'603032', u'603738', u'600633', u'600890', u'603979', u'600272', u'600191', u'603677', u'600684', u'600803', u'601890', u'600793', u'000937', u'600114', u'002030', u'002415', u'600566', u'603160', u'002551', u'603898', u'603559', u'600462', u'300026', u'600538', u'603725', u'603067', u'603993', u'603897', u'603608', u'600703', u'600984', u'603788', u'603123', u'600235', u'603301', u'000738', u'600073', u'600649', u'000415', u'603338', u'603533', u'002304', u'603096', u'600052', u'002131', u'600308', u'600270', u'000777', u'600727', u'603060', u'601018', u'000166', u'603558', u'603022', u'603027', u'600539', u'603111', u'601996', u'603690', u'600399', u'603813', u'600958', u'600219', u'600774', u'600528', u'603885', u'000750', u'600654', u'603029', u'603969', u'600467', u'600380', u'601238', u'600593', u'603678', u'600829', u'600130', u'600901', u'600167', u'000990', u'603733', u'600405', u'600898', u'002202', u'603988', u'603277', u'600055', u'603598', u'002407', u'603520', u'600893', u'600246', u'600615', u'601619', u'600725', u'600489', u'603214', u'603616', u'603233', u'600819', u'600859', u'000625', u'601229', u'603037', u'600165', u'002672', u'600010', u'603839', u'601117', u'000816', u'601628', u'600241', u'601003', u'600601', u'300072', u'600166', u'600739', u'600139', u'300274', u'002603', u'600079', u'603843', u'002373', u'603797', u'600256', u'000839', u'000600', u'600428', u'600120', u'603321', u'002359', u'600260', u'600315', u'603985', u'601212', u'600162', u'600871', u'600234', u'603658', u'000581', u'600802', u'603398', u'002251', u'600608', u'002128', u'002176', u'603585', u'300199', u'002797', u'002050', u'600243', u'600189', u'600112', u'600610', u'002127', u'300244', u'600268', u'000006', u'600823', u'600705', u'002011', u'601336', u'000651', u'600929', u'600350', u'600021', u'000598', u'601668', u'600706', u'600331', u'600759', u'600305', u'600392', u'002463', u'002657', u'601998', u'601908', u'603127', u'600843', u'600321', u'600827', u'600558', u'600036', u'601515', u'603225', u'600328', u'600740', u'600862', u'600995', u'600000', u'600702', u'300024', u'603887', u'600269', u'603757', u'600054', u'601801', u'600009', u'603178', u'600612', u'600587', u'603868', u'600794', u'601222', u'600023', u'600686', u'603360', u'000623', u'600242', u'600008', u'603595', u'002311', u'600105', u'600222', u'600170', u'601717', u'600681', u'603768', u'600346', u'000977', u'601968', u'603330', u'600172', u'002400', u'600058', u'600215', u'601169', u'600348', u'000712', u'603009', u'603555', u'600639', u'603833', u'600479', u'601918', u'600103', u'600696', u'603586', u'603085', u'600027', u'002736', u'002093', u'601599', u'600486', u'603712', u'000768', u'603015', u'600581', u'600207', u'002624', u'000552', u'601858', u'600271', u'600485', u'603688', u'002410', u'600826', u'600683', u'600385', u'002594', u'002074', u'603229', u'600917', u'601669', u'603017', u'000503', u'600022', u'600216', u'600101', u'603998', u'600083', u'600422', u'600765', u'603655', u'600710', u'002249', u'603335', u'600586', u'600857', u'600337', u'603508', u'600487', u'603773', u'000970', u'600720', u'600075', u'000099', u'600511', u'600179', u'601689', u'600236', u'000807', u'603007', u'600980', u'600867', u'600028']
#INDEX_LIST = [u'000099', u'000096', u'000090', u'603648', u'603139', u'603138', u'603136', u'603131', u'002190', u'603133', u'601369', u'002194', u'600784', u'300253', u'300251', u'300257', u'601360', u'603737', u'601866', u'603733', u'603730', u'603738', u'603229', u'603228', u'000625', u'603223', u'603222', u'603225', u'603227', u'603226', u'600369', u'603919', u'603918', u'603917', u'603916', u'603912', u'603823', u'603822', u'603357', u'603356', u'603826', u'603825', u'000911', u'000977', u'603829', u'603828', u'603359', u'603358', u'000913', u'000916', u'600366', u'600933', u'600936', u'600391', u'600939', u'300072', u'300070', u'002332', u'601188', u'002336', u'601186', u'600857', u'600856', u'600855', u'600854', u'600853', u'600852', u'600851', u'600850', u'600859', u'600858', u'601678', u'601677', u'300104', u'002807', u'600444', u'002489', u'002480', u'002482', u'601699', u'600581', u'600580', u'600583', u'600582', u'600585', u'600584', u'600587', u'002249', u'600589', u'600588', u'002244', u'002242', u'002240', u'002241', u'600611', u'600610', u'600613', u'600612', u'600615', u'600614', u'600617', u'600616', u'600619', u'600618', u'601218', u'601212', u'601211', u'601216', u'600039', u'600038', u'600031', u'600030', u'600033', u'600035', u'600037', u'600036', u'002069', u'002062', u'002063', u'002061', u'002064', u'002065', u'601326', u'600109', u'600108', u'600105', u'600104', u'600107', u'600106', u'600101', u'600100', u'600103', u'600102', u'000402', u'000400', u'000401', u'600321', u'600320', u'600323', u'600322', u'000409', u'600329', u'600328', u'002665', u'002662', u'002663', u'002466', u'002465', u'002463', u'002460', u'002461', u'002468', u'603038', u'603039', u'603035', u'603036', u'603037', u'603030', u'603031', u'603032', u'603033', u'600060', u'000792', u'000793', u'000790', u'000795', u'000799', u'601985', u'601988', u'601989', u'000022', u'603108', u'603100', u'603101', u'603103', u'603106', u'600291', u'603690', u'603696', u'603698', u'603699', u'300244', u'603214', u'601857', u'601858', u'603218', u'603585', u'603586', u'603580', u'603588', u'603589', u'603968', u'603969', u'603638', u'603963', u'603960', u'603966', u'603636', u'603637', u'603360', u'603363', u'603365', u'603366', u'603367', u'603368', u'603369', u'600929', u'600926', u'601199', u'002320', u'002322', u'002325', u'002327', u'002326', u'002328', u'600886', u'600822', u'600823', u'600820', u'600821', u'600826', u'600827', u'600824', u'600825', u'600880', u'600828', u'600829', u'600737', u'002815', u'601668', u'600882', u'600735', u'601666', u'002818', u'300115', u'300116', u'601069', u'300113', u'002498', u'002493', u'600637', u'002491', u'002490', u'601689', u'601688', u'002258', u'002254', u'002251', u'002250', u'002252', u'600628', u'600629', u'600624', u'600626', u'600627', u'600620', u'600621', u'600622', u'600623', u'601208', u'601200', u'300088', u'002078', u'002073', u'002075', u'002074', u'002076', u'600488', u'600489', u'000677', u'600480', u'600481', u'600482', u'600483', u'600485', u'600486', u'600487', u'600138', u'600139', u'601336', u'601333', u'600130', u'600131', u'600132', u'600133', u'601339', u'600135', u'600136', u'600137', u'600310', u'600311', u'600312', u'600313', u'000415', u'600315', u'000417', u'000416', u'000419', u'000418', u'002673', u'002672', u'002670', u'002678', u'002475', u'603355', u'002477', u'002470', u'002479', u'600556', u'600557', u'600006', u'600007', u'600000', u'600001', u'600550', u'600003', u'600008', u'600009', u'600558', u'600559', u'600026', u'603029', u'603028', u'603023', u'603022', u'603021', u'603020', u'000301', u'603026', u'603025', u'000780', u'000783', u'000782', u'000785', u'000786', u'000788', u'601991', u'601992', u'601997', u'601996', u'601999', u'601998', u'603117', u'603116', u'603113', u'603111', u'603110', u'603118', u'600663', u'603689', u'603688', u'603686', u'603685', u'603683', u'603680', u'300274', u'300273', u'603203', u'603200', u'603757', u'603758', u'603208', u'603596', u'603595', u'603599', u'603598', u'603979', u'603978', u'603970', u'603977', u'603976', u'603378', u'603377', u'300055', u'600958', u'600959', u'300058', u'300059', u'300296', u'300297', u'300291', u'600066', u'002314', u'002315', u'002317', u'002310', u'002311', u'600831', u'600830', u'600833', u'600832', u'600835', u'600834', u'600837', u'600836', u'600839', u'600838', u'600309', u'600061', u'601058', u'000936', u'300122', u'300124', u'603055', u'600306', u'600305', u'600303', u'600302', u'002268', u'002269', u'000422', u'002261', u'002262', u'600300', u'002266', u'002267', u'600639', u'600638', u'601231', u'601233', u'600633', u'600631', u'600630', u'601238', u'600636', u'600635', u'600634', u'002044', u'002045', u'002046', u'002047', u'002040', u'002041', u'002048', u'002049', u'600497', u'600496', u'600495', u'600493', u'600491', u'600490', u'600499', u'600498', u'600127', u'600126', u'600125', u'600123', u'600122', u'600121', u'600120', u'600129', u'600128', u'000428', u'000429', u'000938', u'600308', u'600307', u'000425', u'000426', u'000935', u'000420', u'000933', u'600301', u'000423', u'002681', u'002440', u'600659', u'002444', u'002447', u'002449', u'600545', u'600012', u'600547', u'600546', u'600017', u'600540', u'600543', u'600019', u'600018', u'600549', u'600548', u'000688', u'002589', u'000680', u'000681', u'000682', u'000683', u'000685', u'000686', u'000687', u'000338', u'000333', u'600011', u'600050', u'600010', u'603800', u'600016', u'600015', u'600462', u'603160', u'000755', u'000752', u'000753', u'000750', u'603165', u'603168', u'603169', u'600392', u'000758', u'000759', u'600393', u'600395', u'600317', u'300267', u'300266', u'601838', u'603768', u'603766', u'603767', u'603568', u'603569', u'603566', u'603567', u'603787', u'603890', u'603788', u'603789', u'000002', u'603897', u'601966', u'600069', u'000001', u'601949', u'603308', u'603309', u'603303', u'603300', u'603301', u'603306', u'600340', u'603305', u'000016', u'300043', u'601500', u'603416', u'300287', u'002309', u'002308', u'002303', u'002306', u'002305', u'002304', u'600808', u'600809', u'600345', u'600804', u'600805', u'600806', u'600807', u'600800', u'600801', u'600802', u'600803', u'300136', u'300134', u'300133', u'002277', u'002276', u'002275', u'002274', u'002273', u'002271', u'600586', u'601222', u'601226', u'601225', u'601229', u'601228', u'002053', u'002052', u'002051', u'002050', u'002056', u'002055', u'002054', u'600263', u'601555', u'600152', u'600153', u'600150', u'600151', u'600156', u'600157', u'600155', u'600158', u'600159', u'600794', u'600795', u'600796', u'600797', u'600790', u'600791', u'600792', u'600793', u'600798', u'600799', u'601311', u'600378', u'600379', u'600372', u'600373', u'600370', u'600371', u'600376', u'600377', u'600375', u'002699', u'002698', u'002690', u'002456', u'002450', u'600570', u'600571', u'600572', u'600573', u'600575', u'600576', u'600577', u'600578', u'600579', u'600206', u'600207', u'600205', u'600202', u'600203', u'600200', u'600201', u'600208', u'600209', u'603161', u'603166', u'603167', u'000506', u'000751', u'600262', u'603283', u'603177', u'603179', u'603178', u'000748', u'603286', u'000697', u'000695', u'000693', u'000690', u'000698', u'601828', u'603779', u'603778', u'603773', u'603777', u'002411', u'000100', u'002410', u'603579', u'603578', u'603577', u'002140', u'603797', u'002415', u'603041', u'002142', u'603799', u'603798', u'603516', u'603043', u'601952', u'601958', u'603319', u'603318', u'603311', u'603313', u'002797', u'603315', u'603316', u'600975', u'600976', u'600977', u'600970', u'600971', u'600973', u'600978', u'600979', u'603955', u'603959', u'603958', u'600819', u'600818', u'600812', u'600811', u'600810', u'600817', u'600816', u'600815', u'600814', u'601038', u'002841', u'002093', u'300146', u'300147', u'300144', u'002202', u'002203', u'002200', u'002204', u'601788', u'601789', u'601328', u'601766', u'600325', u'600327', u'600326', u'000406', u'002512', u'000407', u'600141', u'600143', u'600145', u'600146', u'600149', u'600148', u'600783', u'600782', u'600781', u'002191', u'600787', u'600786', u'600785', u'002195', u'600789', u'600788', u'601366', u'600240', u'000918', u'000919', u'000816', u'000910', u'600360', u'600363', u'600362', u'600365', u'600367', u'000917', u'002428', u'002429', u'002422', u'002426', u'002424', u'601566', u'601567', u'600569', u'600568', u'600567', u'600566', u'600565', u'600563', u'600562', u'600561', u'600560', u'600215', u'600217', u'600216', u'600211', u'600210', u'600213', u'600212', u'600219', u'600218', u'000594', u'000596', u'000597', u'000592', u'000598', u'000599', u'002736', u'002739', u'000776', u'000777', u'000778', u'601811', u'601818', u'601881', u'000961', u'000960', u'603098', u'603099', u'603090', u'603096', u'000969', u'000968', u'000006', u'603326', u'000005', u'603320', u'603321', u'603322', u'603323', u'601968', u'601969', u'603898', u'603899', u'603328', u'603329', u'000008', u'000009', u'600875', u'600702', u'600877', u'600876', u'600871', u'600706', u'600963', u'600962', u'600961', u'600960', u'600967', u'600966', u'600965', u'600969', u'600872', u'600780', u'601021', u'601020', u'601028', u'300159', u'300156', u'002212', u'002217', u'002216', u'002219', u'002218', u'601777', u'601799', u'601798', u'601158', u'601155', u'600688', u'600689', u'600682', u'600683', u'600680', u'600681', u'600686', u'600687', u'600684', u'600685', u'002508', u'002505', u'000972', u'002506', u'002500', u'002503', u'600178', u'600179', u'600175', u'600176', u'600177', u'600170', u'600171', u'600172', u'600173', u'002181', u'002180', u'002183', u'002182', u'600778', u'600779', u'600776', u'600777', u'600774', u'600775', u'600772', u'600773', u'601377', u'600771', u'600196', u'600197', u'600195', u'600192', u'600193', u'600190', u'600191', u'600198', u'600199', u'002439', u'002431', u'002430', u'002434', u'002437', u'600518', u'600519', u'600512', u'600513', u'600510', u'600511', u'600516', u'600517', u'600515', u'600220', u'600221', u'600222', u'600223', u'600225', u'600226', u'600227', u'600228', u'600229', u'000582', u'000581', u'000587', u'000585', u'000584', u'000589', u'002727', u'600426', u'600355', u'000905', u'600425', u'000903', u'600351', u'000901', u'600353', u'600358', u'600359', u'600428', u'600429', u'603159', u'603158', u'000768', u'000767', u'000766', u'000763', u'000762', u'000761', u'002187', u'002186', u'601801', u'601800', u'601808', u'603557', u'603556', u'603555', u'601375', u'603559', u'603558', u'603089', u'603088', u'600770', u'603081', u'603080', u'603083', u'603085', u'603086', u'300383', u'603881', u'603880', u'603883', u'603330', u'603885', u'603336', u'603335', u'603886', u'603889', u'603888', u'603339', u'603338', u'000514', u'000515', u'000517', u'600053', u'000511', u'600998', u'600999', u'600996', u'600997', u'600995', u'600992', u'600993', u'600990', u'600991', u'603429', u'603421', u'000421', u'300166', u'600449', u'601018', u'601019', u'601015', u'601016', u'300168', u'601011', u'601012', u'002225', u'002226', u'002221', u'002223', u'601168', u'601169', u'601163', u'601166', u'002088', u'600698', u'002080', u'600690', u'600693', u'002083', u'002084', u'600694', u'600697', u'600696', u'002534', u'600169', u'600168', u'600163', u'600162', u'600161', u'600160', u'600167', u'600166', u'600165', u'600769', u'600768', u'600765', u'600764', u'600767', u'600766', u'600761', u'600760', u'600763', u'600762', u'600185', u'600184', u'600187', u'600186', u'600181', u'600180', u'600183', u'600182', u'600189', u'600188', u'002405', u'002154', u'002407', u'002400', u'002153', u'002408', u'601579', u'600509', u'600508', u'601588', u'600501', u'600500', u'600503', u'600502', u'600505', u'600507', u'600506', u'600239', u'600238', u'600237', u'000807', u'600235', u'600234', u'600233', u'600232', u'000800', u'600230', u'000576', u'000572', u'000573', u'000570', u'000571', u'002714', u'601198', u'600343', u'000973', u'000970', u'600436', u'000976', u'600346', u'600433', u'600432', u'000978', u'600348', u'600439', u'600438', u'000718', u'000719', u'000712', u'000713', u'000717', u'000715', u'000488', u'000626', u'000627', u'000156', u'000157', u'000623', u'000620', u'000158', u'000159', u'000628', u'000629', u'603520', u'603527', u'603528', u'000021', u'601908', u'000024', u'000025', u'000027', u'000028', u'000029', u'601900', u'601901', u'603180', u'603181', u'603183', u'603186', u'603639', u'603188', u'603189', u'603633', u'603630', u'603856', u'603855', u'603858', u'603859', u'300085', u'600988', u'600985', u'600984', u'600987', u'600986', u'600981', u'600980', u'600983', u'600982', u'600354', u'600356', u'603988', u'603989', u'603458', u'600357', u'603980', u'600350', u'603456', u'603985', u'603986', u'603987', u'600893', u'600352', u'600720', u'000900', u'600723', u'600890', u'600725', u'000866', u'600724', u'601009', u'601008', u'600727', u'601003', u'601002', u'601001', u'601000', u'601007', u'601006', u'601005', u'000861', u'300376', u'000909', u'002238', u'002233', u'002232', u'002230', u'002237', u'002236', u'601177', u'601179', u'601368', u'601965', u'000886', u'000883', u'600758', u'600759', u'600750', u'600751', u'600752', u'600753', u'600754', u'600755', u'600756', u'600757', u'601558', u'603015', u'002147', u'002146', u'002416', u'002143', u'002414', u'002419', u'600535', u'600536', u'600537', u'600530', u'600531', u'600532', u'600533', u'603157', u'600538', u'600539', u'603156', u'002097', u'002095', u'601599', u'002092', u'002091', u'601595', u'002098', u'600248', u'600249', u'000819', u'000818', u'600242', u'600243', u'000817', u'600241', u'600246', u'600247', u'000812', u'000568', u'000565', u'000566', u'000563', u'000562', u'002709', u'002707', u'002705', u'002701', u'600400', u'600401', u'000963', u'600403', u'000965', u'600405', u'600406', u'600408', u'600409', u'000709', u'000708', u'000701', u'000700', u'000703', u'000702', u'603896', u'000707', u'000498', u'000637', u'000636', u'000631', u'000630', u'603533', u'603535', u'603536', u'603538', u'603895', u'002280', u'002281', u'600096', u'002285', u'601919', u'601918', u'000039', u'000037', u'000036', u'000033', u'000032', u'000031', u'000030', u'603628', u'603199', u'603198', u'603197', u'603196', u'603626', u'000897', u'603843', u'601318', u'603848', u'603997', u'603996', u'603993', u'603991', u'603990', u'603999', u'603998', u'601258', u'603444', u'000532', u'000533', u'600077', u'600076', u'000536', u'600070', u'300182', u'000925', u'000927', u'000926', u'000921', u'000920', u'601299', u'601100', u'601101', u'601106', u'601107', u'601108', u'603655', u'002551', u'001979', u'002557', u'002555', u'002558', u'601727', u'002396', u'002390', u'002392', u'002393', u'000166', u'002399', u'600747', u'600746', u'600745', u'600744', u'600743', u'600742', u'600741', u'600740', u'600749', u'600748', u'601618', u'601619', u'601616', u'601611', u'600385', u'002172', u'002174', u'002176', u'002179', u'600523', u'600522', u'600521', u'600520', u'600527', u'600526', u'600525', u'600529', u'600528', u'000828', u'000829', u'600251', u'000821', u'000822', u'600252', u'600255', u'000825', u'000826', u'600256', u'000559', u'600092', u'000550', u'000551', u'000552', u'000554', u'000555', u'000959', u'600419', u'600418', u'600416', u'600415', u'000950', u'000951', u'000952', u'600410', u'000735', u'000737', u'000731', u'000732', u'000733', u'000738', u'601669', u'002602', u'002603', u'002601', u'002608', u'000600', u'000601', u'000602', u'000603', u'603298', u'603299', u'000607', u'000608', u'000609', u'603508', u'603058', u'603059', u'603056', u'603505', u'603506', u'603507', u'603500', u'603501', u'603050', u'603333', u'601877', u'603331', u'603882', u'603337', u'601928', u'601929', u'000049', u'603887', u'000042', u'000043', u'000040', u'000012', u'000046', u'603618', u'603619', u'603611', u'603612', u'603615', u'603616', u'603617', u'603871', u'603876', u'603877', u'603878', u'603879', u'603477', u'603277', u'603278', u'603721', u'300199', u'300197', u'601288', u'601111', u'601113', u'601117', u'601116', u'601118', u'002544', u'002383', u'002386', u'002385', u'002384', u'600279', u'600732', u'600885', u'600730', u'600887', u'600736', u'600881', u'600734', u'600883', u'600738', u'600739', u'600888', u'600889', u'601608', u'601607', u'601601', u'601600', u'002168', u'002167', u'002161', u'600088', u'600089', u'600084', u'600085', u'600086', u'600087', u'600080', u'600081', u'600082', u'600083', u'600648', u'600649', u'600647', u'600644', u'600645', u'600642', u'600643', u'600640', u'600641', u'000547', u'600067', u'600064', u'600065', u'600062', u'600063', u'000541', u'000540', u'600068', u'000548', u'603001', u'600398', u'600399', u'600468', u'600469', u'600390', u'600463', u'600460', u'600461', u'600466', u'600467', u'600396', u'600397', u'000723', u'000722', u'000720', u'000727', u'000726', u'000725', u'000729', u'000728', u'002612', u'000837', u'600265', u'600266', u'600267', u'600260', u'600261', u'000831', u'000830', u'600268', u'600269', u'000839', u'603079', u'603289', u'603288', u'000619', u'000618', u'000617', u'000616', u'000612', u'603519', u'603518', u'603517', u'603040', u'603515', u'603042', u'600421', u'601933', u'603007', u'601939', u'000059', u'603606', u'603605', u'603603', u'603602', u'603601', u'603600', u'000050', u'603609', u'603608', u'603869', u'603868', u'603866', u'603861', u'603860', u'603466', u'603266', u'603260', u'603269', u'603268', u'300324', u'601128', u'000065', u'601126', u'601127', u'603380', u'300032', u'300033', u'603386', u'300039', u'600259', u'000410', u'002574', u'601010', u'603385', u'002570', u'000413', u'002572', u'002573', u'002378', u'002375', u'002373', u'002371', u'601388', u'600892', u'600891', u'600722', u'600897', u'600896', u'600895', u'600894', u'600729', u'600728', u'600899', u'600898', u'600318', u'600319', u'601633', u'600884', u'600253', u'601636', u'000823', u'600705', u'002118', u'600257', u'002110', u'002111', u'002114', u'600099', u'600098', u'600093', u'002283', u'600091', u'600090', u'600097', u'002287', u'600095', u'600094', u'601700', u'600658', u'600655', u'600654', u'600657', u'600656', u'600651', u'600650', u'600653', u'600652', u'600075', u'600074', u'000530', u'000531', u'600071', u'000537', u'600073', u'600072', u'000538', u'000539', u'600079', u'600078', u'603776', u'002027', u'002024', u'002025', u'002022', u'002023', u'002021', u'002028', u'002029', u'600387', u'600386', u'002594', u'002595', u'600383', u'600382', u'600381', u'600380', u'600389', u'600388', u'600479', u'600478', u'600470', u'600472', u'600475', u'600477', u'600476', u'000990', u'000993', u'000996', u'000997', u'000998', u'000999', u'002624', u'600273', u'600272', u'600271', u'600270', u'600277', u'600276', u'600275', u'000848', u'600278', u'000912', u'000668', u'000669', u'000949', u'000662', u'000661', u'000666', u'000667', u'603078', u'600004', u'600005', u'603076', u'603077', u'600555', u'600552', u'600553', u'600002', u'603016', u'600551', u'603383', u'000066', u'000060', u'603387', u'000062', u'000063', u'603388', u'603389', u'000068', u'000069', u'603676', u'603677', u'603678', u'603679', u'603607', u'603818', u'603819', u'603813', u'603811', u'603816', u'603817', u'603499', u'603496', u'300202', u'603708', u'603709', u'603258', u'603707', u'603703', u'603701', u'603926', u'603922', u'000061', u'603928', u'603929', u'600699', u'000815', u'601139', u'600715', u'603027', u'601137', u'600691', u'300027', u'300026', u'002081', u'600692', u'600695', u'002085', u'002368', u'601390', u'002366', u'601398', u'600718', u'600719', u'600868', u'600869', u'600714', u'600867', u'600716', u'600717', u'600710', u'600711', u'600860', u'600861', u'000811', u'000155', u'002109', u'000810', u'002105', u'002107', u'002106', u'002299', u'603920', u'000869', u'002293', u'002292', u'002294', u'600668', u'601717', u'600660', u'600661', u'600662', u'601718', u'600664', u'600665', u'600666', u'600667', u'000520', u'000522', u'000525', u'000524', u'000527', u'600048', u'000528', u'002031', u'002030', u'002745', u'002032', u'002039', u'002038', u'002585', u'600446', u'002581', u'002583', u'600448', u'002588', u'000151', u'000989', u'000988', u'000987', u'000983', u'000982', u'000981', u'002638', u'002635', u'000851', u'000850', u'000852', u'600288', u'600289', u'600286', u'600287', u'600284', u'600285', u'600282', u'600283', u'600280', u'600281', u'603067', u'000679', u'603066', u'603063', u'603060', u'000671', u'603069', u'000676', u'600721', u'603393', u'000070', u'603396', u'603399', u'603398', u'000078', u'603661', u'603660', u'603663', u'603665', u'603667', u'603669', u'603668', u'600022', u'600020', u'603809', u'603808', u'603801', u'601519', u'603803', u'603806', u'600025', u'603488', u'002155', u'603718', u'002152', u'603717', u'603716', u'603711', u'603712', u'603937', u'603936', u'603933', u'603939', u'603938', u'000809', u'600726', u'600917', u'600919', u'300010', u'000956', u'300015', u'300017', u'002358', u'002359', u'002352', u'002353', u'002354', u'600708', u'600879', u'600703', u'600874', u'600701', u'600700', u'600707', u'600870', u'600873', u'600704', u'601098', u'601099', u'002135', u'002137', u'002131', u'002133', u'601628', u'600677', u'600676', u'600675', u'600674', u'600673', u'600672', u'600671', u'600679', u'600678', u'000518', u'000519', u'600059', u'600058', u'600057', u'600056', u'600055', u'600054', u'000510', u'600052', u'600051', u'000513', u'002001', u'002002', u'002004', u'002005', u'002006', u'002007', u'002008', u'000543', u'600452', u'600456', u'600455', u'300024', u'600459', u'600458', u'000806', u'600236', u'600231', u'002648', u'002642', u'002640', u'002646', u'000859', u'600299', u'600298', u'600295', u'600297', u'600296', u'000860', u'600290', u'600293', u'600292', u'601898', u'601899', u'000939', u'601890', u'000858', u'603012', u'000887', u'603010', u'603011', u'000882', u'603017', u'000881', u'603018', u'603019', u'000888', u'600316', u'600258', u'000937', u'000088', u'000089', u'603658', u'603659', u'603128', u'603129', u'603126', u'603127', u'603656', u'603123', u'600422', u'000962', u'600733', u'000932', u'600435', u'601872', u'600423', u'601878', u'603728', u'603729', u'603238', u'603239', u'603232', u'603233', u'603722', u'002362', u'603725', u'603726', u'603727', u'603900', u'603901', u'603903', u'600420', u'603906', u'603908', u'603909', u'000975', u'600731', u'000930', u'000979', u'300315', u'600866', u'603345', u'603833', u'000931', u'603838', u'600864', u'603348', u'600865', u'600862', u'600863', u'000650', u'600712', u'600713', u'603839', u'600901', u'600900', u'600903', u'600909', u'600908', u'600250', u'300003', u'300002', u'300001', u'002345', u'002344', u'002342', u'002340', u'600848', u'600849', u'600840', u'600841', u'600842', u'600843', u'600844', u'600845', u'600846', u'600847', u'002839', u'601086', u'600368', u'601088', u'002831', u'002123', u'002122', u'002121', u'002120', u'002127', u'600027', u'002129', u'002128', u'600592', u'600593', u'600590', u'600591', u'600596', u'600597', u'600594', u'600595', u'600598', u'600599', u'600602', u'600603', u'600600', u'600601', u'600606', u'600607', u'600604', u'600605', u'600608', u'600609', u'601268', u'601515', u'600028', u'600029', u'000503', u'600023', u'000501', u'600021', u'000507', u'601518', u'000504', u'001696', u'002019', u'002018', u'002017', u'002013', u'002012', u'002011', u'002010', u'600118', u'600119', u'600116', u'600117', u'600114', u'600115', u'600112', u'600113', u'600110', u'600111', u'600336', u'600337', u'600335', u'600332', u'600333', u'600330', u'600331', u'600338', u'600339', u'002517', u'002103', u'002651', u'002653', u'002657', u'002568', u'000878', u'000877', u'000876', u'000875', u'000652', u'000651', u'601888', u'000657', u'000656', u'000655', u'601882', u'000659', u'601880', u'600361', u'601886', u'000895', u'603000', u'603003', u'603002', u'603005', u'000890', u'000893', u'603006', u'603009', u'603008', u'000899', u'000898']
INDEX_LIST = ['000001']

#code = input("Input Index Code : ")
startDate = input("Input Start Date (%s) : " %defaultStartDate)
endDate = input("Input End Date (%s) : " %defaultEndDate)


startIdx1 = input("Input Start Num (0): ")
if startIdx1=='':
    startIdx = 0
else:
    startIdx = int(startIdx1)

lines = 0
upcount = 0
downcount = 0

currIdx = 0
for code in INDEX_LIST:
    
    print('Curr Processing Index : %d' %currIdx)
    
    if currIdx < startIdx:
        currIdx+=1
        continue
    
    currIdx+=1
    try:
       
        if startDate=="":
            startDate = defaultStartDate
        if endDate=="":
            endDate = defaultEndDate
            
        outputFileName = 'DataDownload/Data_%s_(%s)_(%s).csv' %(code, startDate, endDate)
        print('Data Download to : %s' %outputFileName)
        
        if os.path.exists(outputFileName):
            print('%s already exist! skip it! ...' %outputFileName)
            continue
        
        df = ts.get_k_data(code, index=isIndex, start=str(startDate), end=str(endDate))
        del df['date']
        del df['code']
        df = df.reset_index(drop=True)
        
        rows = len(df)
        
        print('Data has %d Rows ... ' %rows)
        
        #data process
        TRAIN_DAYS = 16
        PERDICT_DAYS = 1
        RANGE_END = rows-TRAIN_DAYS-PERDICT_DAYS
        
        if rows<=TRAIN_DAYS+(PERDICT_DAYS-1):
            continue
            
        table = pd.DataFrame()
        for i in range(0, TRAIN_DAYS):
            colname1 = 'O%d' %i
            colname2 = 'C%d' %i
            colname3 = 'H%d' %i
            colname4 = 'L%d' %i
            colname5 = 'V%d' %i
            table[colname1] = None
            table[colname2] = None
            table[colname3] = None
            table[colname4] = None
            table[colname5] = None
        table['UP'] = None
        table['DOWN'] = None
                    
        openall = df['open']
                
        for i in range(0, RANGE_END):
           
            open_next = float(openall[i+TRAIN_DAYS+PERDICT_DAYS])
            open_prev = float(openall[i+TRAIN_DAYS])
            
            growth = open_next / open_prev - 1
            kdatapart = df[i:i+TRAIN_DAYS]
            kdatapart = kdatapart.reset_index(drop=True)
            
            #print(kdatapart)
            #print(open_next,open_prev,growth)

            lowlist = []
            highlist = []
            volumelist = []
            feeddata = []
            
            lowpart = kdatapart['low']
            highpart = kdatapart['high']
            volpart = kdatapart['volume']
            openpart = kdatapart['open']
            closepart = kdatapart['close']
            
            for j in range(0, len(kdatapart)):
                lowlist.append(float(lowpart[j]))
                highlist.append(float(highpart[j]))
                volumelist.append(float(volpart[j]))
            low_min = min(lowlist)
            low_max = max(highlist)
            volume_min = min(volumelist)
            volume_max = max(volumelist)
            for j in range(0, len(kdatapart)):
                fopen = float(openpart[j])
                fclose = float(closepart[j])
                fhigh = float(highpart[j])
                flow = float(lowpart[j])
                fvolume = float(volpart[j])
                unified_open = (fopen-low_min)/(low_max-low_min)
                unified_close = (fclose-low_min)/(low_max-low_min)
                unified_high = (fhigh-low_min)/(low_max-low_min)
                unified_low = (flow-low_min)/(low_max-low_min)
                unified_vol = (fvolume-volume_min)/(volume_max-volume_min)
                feeddata.append(unified_open)
                feeddata.append(unified_close)
                feeddata.append(unified_high)
                feeddata.append(unified_low)
                feeddata.append(unified_vol)
            up = 1.0
            down = 0.0
            if growth*100.0>=0.0:
                up = 1.0
                down = 0.0
                upcount += 1
            else:
                up = 0.0
                down = 1.0
                downcount += 1
                
            feeddata.append(up)
            feeddata.append(down)
            
            table.loc[len(table.index)] = feeddata
            
            lines += 1
            
            if i%100==0:
                percent = i / float(RANGE_END) * 100.0
                print("Exporting %0.2f%% Lines:%d Up:%d Down:%d..." %(percent, lines, upcount, downcount))
        
        print('(%d/%d) Saving To %s ...' %(currIdx, len(INDEX_LIST), outputFileName))
        
        table = table.dropna(axis=0, how='any')
        table = table.drop_duplicates()
        
        table.to_csv(path_or_buf=outputFileName, index=False, header=True)
        
        print('Data Saved ...')
        
    except:
        continue